# Column Type Classification Edge Cases
# Tests that column_type is correctly determined based on data_type and column name

version: 2

models:
  - name: column_classification_test
    description: Test column type auto-classification
    meta:
      sst:
        database: ANALYTICS
        schema: test
        table: CLASSIFICATION_TEST
        primary_key:
          - id
    columns:
      # Time dimensions - DATE/TIMESTAMP types should always be time_dimension
      - name: created_at
        meta:
          sst:
            column_type: time_dimension
            data_type: TIMESTAMP_NTZ
            is_enum: false
      
      - name: updated_date
        meta:
          sst:
            column_type: time_dimension
            data_type: DATE
            is_enum: false
      
      - name: event_time
        meta:
          sst:
            column_type: time_dimension
            data_type: TIME
            is_enum: false
      
      # Boolean - Always dimension (not fact)
      - name: is_active
        meta:
          sst:
            column_type: dimension
            data_type: BOOLEAN
            is_enum: false
      
      - name: has_subscription
        meta:
          sst:
            column_type: dimension
            data_type: BOOLEAN
            is_enum: false
      
      # Numeric with is_/has_ prefix - Should be dimension (not fact)
      - name: is_deleted
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            is_enum: false
      
      - name: has_payment_method
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            is_enum: false
      
      # Edge case: Starts with "is" but not "is_"
      - name: issue_count
        meta:
          sst:
            column_type: fact
            data_type: NUMBER
            is_enum: false
      
      # Edge case: Starts with "has" but not "has_"
      - name: hash_value
        meta:
          sst:
            column_type: fact
            data_type: NUMBER
            is_enum: false
      
      # Numeric without is_/has_ - Should be fact
      - name: revenue
        meta:
          sst:
            column_type: fact
            data_type: NUMBER
            is_enum: false
      
      - name: quantity
        meta:
          sst:
            column_type: fact
            data_type: NUMBER
            is_enum: false
      
      - name: user_id
        meta:
          sst:
            column_type: fact
            data_type: NUMBER
            is_enum: false
      
      # String types - Always dimension
      - name: status
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            is_enum: true
      
      - name: name
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            is_enum: false
      
      # INVALID: fact with is_enum=true
      - name: bad_revenue
        meta:
          sst:
            column_type: fact
            data_type: NUMBER
            is_enum: true  # ERROR - facts can't be enums
      
      # INVALID: time_dimension with is_enum=true
      - name: bad_created_at
        meta:
          sst:
            column_type: time_dimension
            data_type: TIMESTAMP_NTZ
            is_enum: true  # ERROR - time dimensions can't be enums
      
      # Case sensitivity tests
      - name: IS_ACTIVE_UPPER
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            is_enum: false
      
      - name: Has_Subscription_Mixed
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            is_enum: false
      
      # Just "is_" or "has_" with nothing after
      - name: is_
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            is_enum: false
      
      - name: has_
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            is_enum: false

