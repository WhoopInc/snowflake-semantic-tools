# YAML Parsing - Special Characters in Field Values
# Category 1: Tests ALL special character scenarios

version: 2

models:
  - name: special_chars_comprehensive
    description: |-
      Test every special character edge case:
      Leading: >, |, &, *, @, #, !, %, ^
      Trailing: \, /, :, ;, ?
      Embedded: {{, }}, {%, %}, {#, #}
      Quotes: ', ", `, escaped
      Whitespace: \n, \r\n, \t
      Unicode: emoji, accents, non-Latin
      Control: ASCII 0-31
    meta:
      sst:
        database: ANALYTICS
        schema: test
        table: SPECIAL_CHARS
        primary_key:
          - id
    columns:
      # Leading special characters
      - name: leading_greater
        description: "Value starts with >"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - " >redirect"
              - " >output"
            is_enum: false
      
      - name: leading_pipe
        description: "Value starts with |"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - " |pipe"
              - " |literal block"
            is_enum: false
      
      - name: leading_ampersand
        description: "Value starts with &"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - " &anchor"
              - " &reference"
            is_enum: false
      
      - name: leading_asterisk
        description: "Value starts with *"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - " *alias"
              - " *wildcard"
            is_enum: false
      
      - name: leading_at
        description: "Value starts with @"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - " @mention"
              - " @username"
            is_enum: false
      
      - name: leading_hash
        description: "Value starts with #"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "#hashtag"
              - "#comment"
            is_enum: false
      
      - name: leading_exclamation
        description: "Value starts with !"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "!important"
              - "!bang"
            is_enum: false
      
      - name: leading_percent
        description: "Value starts with %"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "%percent"
              - "%modulo"
            is_enum: false
      
      - name: leading_caret
        description: "Value starts with ^"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "^start_anchor"
              - "^regex"
            is_enum: false
      
      # Trailing special characters
      - name: trailing_backslash
        description: "Value ends with backslash"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "path\\"
              - "escape\\"
            is_enum: false
      
      - name: trailing_forward_slash
        description: "Value ends with /"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "path/"
              - "url/"
            is_enum: false
      
      - name: trailing_colon
        description: "Value ends with :"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "label:"
              - "key:"
            is_enum: false
      
      - name: trailing_semicolon
        description: "Value ends with ;"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "statement;"
              - "end;"
            is_enum: false
      
      - name: trailing_question
        description: "Value ends with ?"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "question?"
              - "really?"
            is_enum: false
      
      # Embedded Jinja template characters
      - name: embedded_double_braces
        description: "Jinja double braces"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "{ {@aiql query} }"
              - "text { {var} } more"
            is_enum: false
      
      - name: embedded_percent_braces
        description: "Jinja percent braces"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "{ % set x = 1 % }"
              - "{ %- if true -% }"
            is_enum: false
      
      - name: embedded_hash_braces
        description: "Jinja comment braces"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "{ # comment # }"
              - "text { # note # } more"
            is_enum: false
      
      # Quote variations
      - name: single_quotes
        description: "Single quote variations"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "O'Reilly"
              - "McDonald's"
              - "It's"
              - "'quoted'"
              - "can't"
            is_enum: false
      
      - name: double_quotes
        description: "Double quote variations"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - 'He said "hi"'
              - 'The "best" one'
              - '"fully quoted"'
            is_enum: false
      
      - name: backticks
        description: "Backtick variations"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - " `code`"
              - " `identifier`"
            is_enum: false
      
      - name: escaped_quotes
        description: "Escaped quote variations"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "She said \\\"hello\\\""
              - "It\\'s working"
            is_enum: false
      
      # Newlines and line breaks
      - name: newline_variations
        description: "Newline character variations"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "Line 1\\nLine 2"
              - "Windows\\r\\nLine"
              - "Multiple\\n\\n\\nLines"
            is_enum: false
      
      # Tab characters
      - name: tab_characters
        description: "Tab character handling"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "Column\\tValue"
              - "Tab\\there"
              - "Multiple\\t\\tTabs"
            is_enum: false
      
      # Unicode characters
      - name: unicode_comprehensive
        description: "Unicode character variations"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "CafÃ©"
              - "naÃ¯ve"
              - "åŒ—äº¬"
              - "Ù…Ø±Ø­Ø¨Ø§"
              - "ÐŸÑ€Ð¸Ð²ÐµÑ‚"
              - "ðŸŽ‰ðŸŽŠðŸŽˆ"
              - "Ã‘oÃ±o"
              - "SÃ£o Paulo"
            is_enum: false
      
      # Zero-width characters (these can break parsing)
      - name: zero_width_chars
        description: "Zero-width character handling"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "zeroâ€‹widthâ€‹space"
              - "zeroâ€Œwidthâ€Œjoiner"
            is_enum: false
      
      # Control characters (ASCII 0-31)
      - name: control_characters
        description: "Control character handling"
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            sample_values:
              - "bell\\x07char"
              - "null\\x00char"
              - "escape\\x1bchar"
            is_enum: false

# YAML Structure Edge Cases
snowflake_metrics:
  # Empty string values
  - name: empty_string_name
    expr: ""
    tables:
      - "{{ table('test') }}"
    description: Metric with empty expression string
  
  # Null values
  - name: null_description
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: null
  
  # Empty lists
  - name: empty_synonyms
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    synonyms: []
    description: Metric with empty synonyms list
  
  # Mixed list types
  - name: mixed_list_tables
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
      - 123
      - null
      - {}
    description: Tables list with mixed types
  
  # Very long description (10,000+ chars)
  - name: huge_description
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: "This is a very long description that goes on and on and on for thousands of characters to test how the system handles extremely verbose documentation that might come from auto-generation or copy-paste from external sources and we need to make sure it doesn't break anything or cause performance issues or memory problems or parsing failures and this continues for many more characters..."

# Field Name Edge Cases
snowflake_metrics:
  # Spaces in metric name (quoted)
  - name: "metric with spaces"
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric name with spaces
  
  # Special characters in metric name
  - name: "metric-with-hyphens"
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric name with hyphens
  
  - name: "metric.with.dots"
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric name with dots
  
  - name: "metric_with!exclamation"
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric name with exclamation
  
  # Reserved SQL words as names
  - name: SELECT
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric named with SQL reserved word SELECT
  
  - name: FROM
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric named with SQL reserved word FROM
  
  # Numbers in names
  - name: metric1
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric with trailing number
  
  - name: "1metric"
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric starting with number
  
  - name: metric_2024_q4
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric with numbers embedded
  
  # Very long name (500+ characters)
  - name: "this_is_an_extremely_long_metric_name_that_goes_on_and_on_for_hundreds_of_characters_to_test_system_limits_and_ensure_we_handle_excessively_verbose_naming_conventions_that_might_come_from_auto_generated_code_or_overly_descriptive_naming_patterns_and_we_need_to_make_sure_this_doesnt_break_anything_in_the_validation_parsing_or_generation_systems_and_continues_for_many_more_characters_to_reach_the_five_hundred_character_threshold_which_is_quite_long_for_a_field_name_but_technically_possible_in_yaml_and_we_should_handle_it_gracefully"
    expr: "SUM(x)"
    tables:
      - "{{ table('test') }}"
    description: Metric with very long name

