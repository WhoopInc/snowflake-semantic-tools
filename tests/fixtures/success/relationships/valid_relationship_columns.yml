# Test fixtures for valid relationship definitions
# All should pass validation without errors

snowflake_relationships:
  # Test 1: Simple relationship
  - name: users_to_orders
    description: "Valid: one user has many orders"
    left_table: "{{ table('users') }}"
    right_table: "{{ table('orders') }}"
    relationship_conditions:
      - "{{ column('users', 'id') }} = {{ column('orders', 'user_id') }}"
  
  # Test 2: Reverse relationship
  - name: orders_to_users
    description: "Valid: many orders belong to one user"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('users') }}"
    relationship_conditions:
      - "{{ column('orders', 'user_id') }} = {{ column('users', 'id') }}"
  
  # Test 3: Composite key relationship (multiple conditions)
  - name: orders_to_order_line_items
    description: "Valid: relationship with multiple column mappings"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('order_line_items') }}"
    relationship_conditions:
      - "{{ column('orders', 'id') }} = {{ column('order_line_items', 'order_id') }}"
      - "{{ column('orders', 'created_date') }} = {{ column('order_line_items', 'order_date') }}"
  
  # Test 4: Self-referencing relationship
  - name: users_to_users_referrals
    description: "Valid: self-referencing relationship (users refer other users)"
    left_table: "{{ table('users') }}"
    right_table: "{{ table('users') }}"
    relationship_conditions:
      - "{{ column('users', 'id') }} = {{ column('users', 'referred_by_user_id') }}"
  
  # Test 5: Date-based relationship
  - name: orders_to_calendar
    description: "Valid: joining orders to calendar by date"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('calendar') }}"
    relationship_conditions:
      - "{{ column('orders', 'created_date') }} = {{ column('calendar', 'date') }}"
  
  # Test 6: Uppercase table and column names (tests case handling)
  - name: uppercase_relationship
    description: "Valid: relationship with uppercase references"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('products') }}"
    relationship_conditions:
      - "{{ column('orders', 'PRODUCT_ID') }} = {{ column('products', 'ID') }}"
  
  # Test 7: ASOF relationship (temporal join)
  - name: orders_to_prices_asof
    description: "Valid: ASOF relationship for point-in-time joins"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('prices') }}"
    relationship_conditions:
      - "{{ column('orders', 'product_id') }} = {{ column('prices', 'product_id') }}"
      - "{{ column('orders', 'order_date') }} >= {{ column('prices', 'effective_date') }}"
  
  # Test 8: Three-column composite key
  - name: complex_composite_key
    description: "Valid: relationship with three-column composite key"
    left_table: "{{ table('fact_sales') }}"
    right_table: "{{ table('dim_time') }}"
    relationship_conditions:
      - "{{ column('fact_sales', 'year') }} = {{ column('dim_time', 'year') }}"
      - "{{ column('fact_sales', 'month') }} = {{ column('dim_time', 'month') }}"
      - "{{ column('fact_sales', 'day') }} = {{ column('dim_time', 'day') }}"
