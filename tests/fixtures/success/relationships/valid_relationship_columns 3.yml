# Test fixtures for valid relationship column references
# These should all pass validation without errors

snowflake_relationships:
  # Test 1: Simple one-to-many relationship
  - name: users_to_orders
    description: "Valid: one user has many orders"
    left_table: "{{ table('users') }}"
    right_table: "{{ table('orders') }}"
    join_type: left_outer
    relationship_type: one_to_many
    relationship_columns:
      - left_column: "{{ column('users', 'id') }}"
        right_column: "{{ column('orders', 'user_id') }}"
  
  # Test 2: Many-to-one relationship
  - name: orders_to_users
    description: "Valid: many orders belong to one user"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('users') }}"
    join_type: left_outer
    relationship_type: many_to_one
    relationship_columns:
      - left_column: "{{ column('orders', 'user_id') }}"
        right_column: "{{ column('users', 'id') }}"
  
  # Test 3: Composite key relationship
  - name: orders_to_order_line_items
    description: "Valid: relationship with multiple column mappings"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('order_line_items') }}"
    join_type: left_outer
    relationship_type: one_to_many
    relationship_columns:
      - left_column: "{{ column('orders', 'id') }}"
        right_column: "{{ column('order_line_items', 'order_id') }}"
      - left_column: "{{ column('orders', 'created_date') }}"
        right_column: "{{ column('order_line_items', 'order_date') }}"
  
  # Test 4: Self-referencing relationship
  - name: users_to_users_referrals
    description: "Valid: self-referencing relationship (users refer other users)"
    left_table: "{{ table('users') }}"
    right_table: "{{ table('users') }}"
    join_type: left_outer
    relationship_type: one_to_many
    relationship_columns:
      - left_column: "{{ column('users', 'id') }}"
        right_column: "{{ column('users', 'referred_by_user_id') }}"
  
  # Test 5: Date-based relationship
  - name: orders_to_calendar
    description: "Valid: joining orders to calendar by date"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('calendar') }}"
    join_type: left_outer
    relationship_type: many_to_one
    relationship_columns:
      - left_column: "{{ column('orders', 'created_date') }}"
        right_column: "{{ column('calendar', 'date') }}"
  
  # Test 6: Uppercase table and column names (should handle case insensitivity)
  - name: uppercase_relationship
    description: "Valid: relationship with uppercase references (tests case handling)"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('products') }}"
    join_type: inner
    relationship_type: many_to_one
    relationship_columns:
      - left_column: "{{ column('orders', 'PRODUCT_ID') }}"
        right_column: "{{ column('products', 'ID') }}"
  
  # Test 7: Multiple relationships between same tables
  - name: orders_to_users_by_created_user
    description: "Valid: alternative relationship between orders and users"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('users') }}"
    join_type: left_outer
    relationship_type: many_to_one
    relationship_columns:
      - left_column: "{{ column('orders', 'created_by_user_id') }}"
        right_column: "{{ column('users', 'id') }}"
  
  # Test 8: Full outer join
  - name: orders_full_join_shipments
    description: "Valid: full outer join between orders and shipments"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('shipments') }}"
    join_type: full_outer
    relationship_type: one_to_one
    relationship_columns:
      - left_column: "{{ column('orders', 'id') }}"
        right_column: "{{ column('shipments', 'order_id') }}"
  
  # Test 9: Inner join
  - name: orders_inner_join_products
    description: "Valid: inner join for required relationships"
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('products') }}"
    join_type: inner
    relationship_type: many_to_one
    relationship_columns:
      - left_column: "{{ column('orders', 'product_id') }}"
        right_column: "{{ column('products', 'id') }}"
  
  # Test 10: Three-column composite key
  - name: complex_composite_key
    description: "Valid: relationship with three-column composite key"
    left_table: "{{ table('fact_sales') }}"
    right_table: "{{ table('dim_time') }}"
    join_type: left_outer
    relationship_type: many_to_one
    relationship_columns:
      - left_column: "{{ column('fact_sales', 'year') }}"
        right_column: "{{ column('dim_time', 'year') }}"
      - left_column: "{{ column('fact_sales', 'month') }}"
        right_column: "{{ column('dim_time', 'month') }}"
      - left_column: "{{ column('fact_sales', 'day') }}"
        right_column: "{{ column('dim_time', 'day') }}"

