# Comprehensive Required Field Validation
# Tests that ALL required fields are properly validated for each component type

# METRICS - Required: name, expr, tables
snowflake_metrics:
  # Missing name
  - expr: "SUM(amount)"
    tables:
      - "{{ table('transactions') }}"
    description: Metric missing name field
  
  # Missing expr
  - name: missing_expr
    tables:
      - "{{ table('transactions') }}"
    description: Metric missing expr field
  
  # Missing tables
  - name: missing_tables
    expr: "SUM(amount)"
    description: Metric missing tables field
  
  # Empty name
  - name: ""
    expr: "SUM(amount)"
    tables:
      - "{{ table('transactions') }}"
    description: Metric with empty name
  
  # Empty expr
  - name: empty_expr
    expr: ""
    tables:
      - "{{ table('transactions') }}"
    description: Metric with empty expr
  
  # Empty tables list
  - name: empty_tables_list
    expr: "SUM(amount)"
    tables: []
    description: Metric with empty tables list
  
  # Tables as string instead of list
  - name: tables_wrong_type
    expr: "SUM(amount)"
    tables: "{{ table('transactions') }}"
    description: Metric with tables as string instead of list
  
  # Null values
  - name: null_expr
    expr: null
    tables:
      - "{{ table('transactions') }}"
    description: Metric with null expr
  
  # Just whitespace
  - name: whitespace_expr
    expr: "   "
    tables:
      - "{{ table('transactions') }}"
    description: Metric with whitespace-only expr

# RELATIONSHIPS - Required: name, left_table, right_table, relationship_conditions
snowflake_relationships:
  # Missing name
  - left_table: "{{ table('orders') }}"
    right_table: "{{ table('users') }}"
    relationship_conditions:
      - "{{ column('orders', 'user_id') }} = {{ column('users', 'id') }}"
  
  # Missing left_table
  - name: missing_left_table
    right_table: "{{ table('users') }}"
    relationship_conditions:
      - "{{ column('orders', 'user_id') }} = {{ column('users', 'id') }}"
  
  # Missing right_table
  - name: missing_right_table
    left_table: "{{ table('orders') }}"
    relationship_conditions:
      - "{{ column('orders', 'user_id') }} = {{ column('users', 'id') }}"
  
  # Missing relationship_conditions
  - name: missing_relationship_conditions
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('users') }}"
  
  # Empty relationship_conditions list
  - name: empty_relationship_conditions
    left_table: "{{ table('orders') }}"
    right_table: "{{ table('users') }}"
    relationship_conditions: []

# FILTERS - Required: name, expr
snowflake_filters:
  # Missing name
  - expr: "status = 'active'"
    description: Filter missing name
  
  # Missing expr
  - name: missing_expr
    description: Filter missing expr
  
  # Empty name
  - name: ""
    expr: "status = 'active'"
    description: Filter with empty name
  
  # Empty expr
  - name: empty_expr
    expr: ""
    description: Filter with empty expr
  
  # Null expr
  - name: null_expr
    expr: null
    description: Filter with null expr

# VERIFIED QUERIES - Required: name, sql, tables
snowflake_verified_queries:
  # Missing name
  - sql: "SELECT * FROM transactions"
    tables:
      - "{{ table('transactions') }}"
    description: Query missing name
  
  # Missing sql
  - name: missing_sql
    tables:
      - "{{ table('transactions') }}"
    description: Query missing sql
  
  # Missing tables
  - name: missing_tables
    sql: "SELECT * FROM transactions"
    description: Query missing tables
  
  # Empty sql
  - name: empty_sql
    sql: ""
    tables:
      - "{{ table('transactions') }}"
    description: Query with empty sql
  
  # Empty tables list
  - name: empty_tables_list
    sql: "SELECT * FROM transactions"
    tables: []
    description: Query with empty tables list

# CUSTOM INSTRUCTIONS - Required: name, AND (sql_generation OR question_categorization)
snowflake_custom_instructions:
  # Missing name
  - sql_generation: "Use fiscal calendar"
    description: Instruction missing name
  
  # Missing both sql_generation and question_categorization
  - name: missing_both
    description: Instruction missing both required fields
  
  # Empty sql_generation
  - name: empty_sql_generation
    sql_generation: ""
    description: Instruction with empty sql_generation
  
  # Null values
  - name: null_sql_generation
    sql_generation: null
    description: Instruction with null sql_generation

# SEMANTIC VIEWS - Required: name, tables
semantic_views:
  # Missing name
  - tables:
      - "{{ table('transactions') }}"
    description: View missing name
  
  # Missing tables
  - name: missing_tables
    description: View missing tables
  
  # Empty name
  - name: ""
    tables:
      - "{{ table('transactions') }}"
    description: View with empty name
  
  # Empty tables list
  - name: empty_tables_list
    tables: []
    description: View with empty tables list
  
  # Tables as string instead of list
  - name: tables_wrong_type
    tables: "{{ table('transactions') }}"
    description: View with tables as string

