# PII Protection - Sample Values with Direct Identifiers
# These should ERROR - direct_identifier columns should never have sample values

version: 2

models:
  - name: users_with_pii_leak
    description: Table with PII that has sample values (ERROR)
    meta:
      sst:
        database: ANALYTICS
        schema: memberships
        table: USERS
        primary_key:
          - user_id
    columns:
      # ERROR: Email with samples
      - name: email
        description: User email address
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            privacy_category: direct_identifier
            sample_values:
              - john.doe@example.com
              - jane.smith@example.com
            is_enum: false
      
      # ERROR: SSN with samples
      - name: ssn
        description: Social security number
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            privacy_category: direct_identifier
            sample_values:
              - "123-45-6789"
              - "987-65-4321"
            is_enum: false
      
      # ERROR: Phone with samples
      - name: phone_number
        description: Phone number
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            privacy_category: direct_identifier
            sample_values:
              - "+1-555-123-4567"
              - "+1-555-987-6543"
            is_enum: false
      
      # OK: quasi_identifier can have samples
      - name: zip_code
        description: ZIP code
        meta:
          sst:
            column_type: dimension
            data_type: TEXT
            privacy_category: quasi_identifier
            sample_values:
              - "02134"
              - "94102"
            is_enum: false
      
      # OK: No privacy category
      - name: user_id
        description: User ID
        meta:
          sst:
            column_type: dimension
            data_type: NUMBER
            sample_values:
              - 12345
              - 67890
            is_enum: false

